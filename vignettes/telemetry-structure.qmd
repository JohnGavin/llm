---
title: "Project Structure"
author: "John Gavin"
date: "`r Sys.Date()`"
format: 
  html:
    toc: true
    toc-depth: 3
    page-layout: full
    code-fold: true
vignette: >
  %\VignetteIndexEntry{Project Structure}
  %\VignetteEngine{quarto::html}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  message = FALSE,
  warning = FALSE
)
library(fs)
library(gh)
library(tibble)
library(dplyr)
library(knitr)
library(lubridate)

owner <- "JohnGavin"
repo <- "llm"
```

## Directory Structure

```{r dir-tree}
#| comment: ""
tryCatch({
  tree_output <- capture.output(fs::dir_tree(recurse = 2))
  cat(paste(head(tree_output, 50), collapse = "\n"))
}, error = function(e) cat("Tree generation failed"))
```

## File Counts

```{r file-counts}
all_files <- tryCatch({
  fs::dir_ls(recurse = TRUE, type = "file") |>
    as.character() |>
    {\(x) x[!grepl("(\.git|_targets|renv)", x)]}()
}, error = function(e) character(0))

if (length(all_files) > 0) {
  file_counts <- tibble(path = all_files) |>
    mutate(extension = tools::file_ext(path)) |>
    count(extension, name = "count") |>
    arrange(desc(count))
  kable(head(file_counts, 20))
}
```

## GitHub Stats

```{r github-stats}
repo_stats <- tryCatch({
  gh::gh("/repos/{owner}/{repo}", owner = owner, repo = repo)
}, error = function(e) NULL)

if (!is.null(repo_stats)) {
  stats_table <- tibble(
    Metric = c("Stars", "Forks", "Open Issues"),
    Value = c(repo_stats$stargazers_count, repo_stats$forks_count, repo_stats$open_issues_count)
  )
  kable(stats_table)
}
```
